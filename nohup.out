/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.2
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py:1742: ConvergenceWarning: Maximum number of iterations 500 reached. Increase it to improve convergence.
  warnings.warn(
/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py:1742: ConvergenceWarning: Maximum number of iterations 500 reached. Increase it to improve convergence.
  warnings.warn(
User-ID     243     254     487     507     ...  278535  278582  278633  278843
ISBN                                        ...                                
000649840X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
002026478X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
0020442203     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
002542730X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
0028604199     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
...            ...     ...     ...     ...  ...     ...     ...     ...     ...
3426029553     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3442437407     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3442541751     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3492045170     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
8873122933     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0

[2125 rows x 3577 columns]
Traceback (most recent call last):
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 116, in <module>
    main()
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 82, in main
    print(calculate_rank(v_matrix)[0])
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 97, in calculate_rank
    W = model.fit_transform(matrix)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py", line 1640, in fit_transform
    W, H, n_iter = self._fit_transform(X, W=W, H=H)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py", line 1708, in _fit_transform
    W, H, n_iter = _fit_coordinate_descent(
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py", line 501, in _fit_coordinate_descent
    violation += _update_coordinate_descent(
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py", line 388, in _update_coordinate_descent
    XHt = safe_sparse_dot(X, Ht)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/utils/extmath.py", line 206, in safe_sparse_dot
    sparse.issparse(a)
  File "/usr/lib/python3/dist-packages/scipy/sparse/_base.py", line 1291, in isspmatrix
    def isspmatrix(x):
KeyboardInterrupt
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.2
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py:1742: ConvergenceWarning: Maximum number of iterations 500 reached. Increase it to improve convergence.
  warnings.warn(
/home/benji/.local/lib/python3.10/site-packages/sklearn/decomposition/_nmf.py:1742: ConvergenceWarning: Maximum number of iterations 500 reached. Increase it to improve convergence.
  warnings.warn(
User-ID     243     254     487     507     ...  278535  278582  278633  278843
ISBN                                        ...                                
000649840X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
002026478X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
0020442203     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
002542730X     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
0028604199     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
...            ...     ...     ...     ...  ...     ...     ...     ...     ...
3426029553     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3442437407     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3442541751     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
3492045170     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0
8873122933     0.0     0.0     0.0     0.0  ...     0.0     0.0     0.0     0.0

[2125 rows x 3577 columns]
Traceback (most recent call last):
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 116, in <module>
    if __name__ == "__main__":
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 82, in main
    print(calculate_rank(v_matrix)[0])
  File "/home/benji/cortical-thickness/nmf-book-example/./book-nmf.py", line 102, in calculate_rank
    RMSE = np.sqrt(mean_squared_error(matrix, V))
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/metrics/_regression.py", line 570, in mean_squared_error
    output_errors = _average((y_true - y_pred) ** 2, axis=0, weights=sample_weight)
  File "/home/benji/.local/lib/python3.10/site-packages/sklearn/utils/_array_api.py", line 705, in _average
    def _average(a, axis=None, weights=None, normalize=True, xp=None):
KeyboardInterrupt
